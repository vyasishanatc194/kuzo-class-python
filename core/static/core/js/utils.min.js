"use strict";var utils={action_ids:[],updateOrder:function(e,t){var n=$(e).serializeArray();$.ajax({url:t,type:"POST",data:n,success:function(e){console.log(e)}})},sortableTable:function(e,t,n){console.debug("sortableTable",e,t),$(e+" tbody").sortable({cursor:"move",axis:"y",containment:"parent",items:"tr",distance:10,tolerance:"pointer",cancel:"a",helper:function(e,t){return t.children().each(function(){$(this).width($(this).width())}),t},update:function(){utils.orderTableRows(e,t),void 0!==n&&n()}}).disableSelection(),utils.orderTableRows(e,t)},sortableTableDragula:function(e,t,n){console.debug("sortableTableDragula",e,t);var i=dragula({containers:[$(e).find("tbody")[0]],direction:"vertical"});i.on("drop",function(i,a,o,c){utils.orderTableRows(e,t),void 0!==n&&n()}),i.on("cloned",function(e,t,n){}),utils.orderTableRows(e,t)},orderTableRows:function(e,t){console.debug("orderTableRows",e,t);var n=[];$(e+" tbody tr").each(function(){var e=$(this).index()+1;$(this).attr("data-order",e),n.push({id:$(this).data("id"),order:e})}),$(t).val(JSON.stringify(n))},addTableRowActions:function(e){console.debug("addTableRowActions");var t=$("#row-actions").html();$("#row-actions").remove(),$(e+"_wrapper .row .col-sm-6").first().html(t),$(e+" tbody tr input[type=checkbox]").on("ifChecked",function(){utils.action_ids.push($(this).val())}),$(e+" tbody tr input[type=checkbox]").on("ifUnchecked",function(){var e=utils.action_ids.indexOf($(this).val());e>-1&&utils.action_ids.splice(e,1)}),$("#select-all").on("ifChecked",function(){$("input[name^='action']").iCheck("check")}),$("#select-all").on("ifUnchecked",function(){$("input[name^='action']").iCheck("uncheck")}),$("#action-submit").click(function(){var e=$("#action-select").val();$("#action-modal .action-name").html(e),console.log(e),console.log(utils.action_ids),$("#action-modal .btn-danger").unbind("click").on("click",function(){$.ajax({url:window.action_url,type:"POST",data:{csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val(),action:e,primary_keys:JSON.stringify(utils.action_ids)},success:function(e){$("#action-modal").modal("hide"),e.result?(console.debug(e),window.location.reload()):console.error(e)}})}),$("#action-modal").modal("show")})},inlineFormAdd:function(e,t){$(document).on("click","#add-inline",function(){event.preventDefault();var n=$("#"+e+"-template").html(),i=parseInt($("#id_"+e+"-TOTAL_FORMS").attr("value"),10),a=n.replace(/__prefix__/g,i);$("#"+e+"-table tbody").append(a),$("#id_"+e+"-TOTAL_FORMS").attr("value",i+1),null!=t&&t()})},inlineFormRemove:function(){$(document).on("click",".inlineform-remove",function(){$(this).hasClass("btn-default")?($(this).removeClass("btn-default").addClass("btn-danger").find("i").removeClass("fa-minus").addClass("fa-times"),$(this).parent().find("input[type=checkbox]").attr("checked","checked")):$(this).hasClass("btn-danger")&&($(this).removeClass("btn-danger").addClass("btn-default").find("i").removeClass("fa-times").addClass("fa-minus"),$(this).parent().find("input[type=checkbox]").removeAttr("checked")),"new"===$(this).attr("data-button")&&$(this).parent().parent().remove()})}};